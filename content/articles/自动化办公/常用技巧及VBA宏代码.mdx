---
category: "automation-office"
title: "Word中图注及图片批量处理技巧总结"
date: "2024-10-15"
excerpt: "Word使用教程、VBA宏代码"
tags: ["自动化", "Word", "教程"]
isRecommended: true  # 设置为推荐文章，将显示在首页推荐阅读区域
isSticky: true      # 设置为置顶文章，将显示在文章列表顶部
---

# VBA宏代码使用教程

## 编写和运行VBA宏
- 打开Word文档，按下“Alt + F11”组合键打开VBA编辑器。
- 在VBA编辑器中，插入一个新的模块（通过“插入”菜单 - >“模块”）。
- 在模块中输入代码。
- **运行宏**：在VBA编辑器中点击“运行”按钮或者将光标定位在宏代码中，按下“F5”键来运行宏。

Tips：在进行任何批量操作之前，最好先备份原始文档，以免误删重要内容。

# 删除不规范图注的几种方法介绍
## 使用样式功能（如果图注应用了特定样式）
- 打开“样式”窗格。可以通过点击“开始”选项卡中“样式”组右下角的小箭头来打开。
- 在“样式”窗格中，找到并右键单击图注所应用的样式。
- 选择“选择所有X个实例”（X为应用该样式的段落数），这样就会选中所有应用此样式的图注。 
- 按下“Delete”键，即可删除所有选中的图注。

## 使用查找和替换功能（如果图注有一定规律）
### 分析图注的规律
假设图注都以“图`X - `”开头（X为数字），后面跟着图注内容。或者图注都位于特定的位置，如在图表下方且有特定的格式（比如字号、字体等）。
### 使用查找和替换对话框
- 按下“Ctrl + H”组合键打开“查找和替换”对话框。 
- 在“查找内容”框中，根据图注的规律输入内容。
- 例如，如果图注都以“图”字开头，后面跟着一个或多个数字和一个空格，你可以输入“图 `[0-9]{1,}`”（这里使用了通配符，`[0 - 9]{1,}`表示一个或多个数字）。 
- 将“替换为”框留空。 
- 点击“更多”按钮，勾选“使用通配符”选项（如果在查找内容中使用了通配符）。 
- 点击“全部替换”按钮，Word会查找并删除符合条件的图注内容。 

## 使用VBA宏（对于复杂情况）
宏代码如下：
    ```vb
    Sub DeleteFigureCaptions() 
    Dim para As Paragraph 
    For Each para In ActiveDocument.Paragraphs 
    '假设图注所在段落包含"图注"两个字 
    If InStr(para.Range.Text, "图注") > 0 Then 
    para.Range.Delete 
    End If 
    End For 
    End Sub
    ```
可以根据实际情况修改代码中的条件判断部分。如果图注有其他标志性的文字或者格式特点，可以相应地调整`If`语句中的条件。 

