# 第十四章 恶意代码防范技术原理

概念

定义：Malicious Code，是一种违背目标系统安全策略的程序代码，会造成目标系统信息泄露、资源滥用，破坏系统的完整性及可用性。

恶意代码攻击模型

作用过程：

1. 侵入系统
2. 维持或提升已有的权限
3. 隐蔽。对恶意代码改名、删除源文件或修改系统安全策略
4. 潜伏。在具有足够的权限并满足某些条件时发作
5. 破坏。造成信息丢失、泄密，系统完整性被破坏等。
6. 重复前面5步对新的目标实施攻击过程。

恶意代码生存技术

1. 反跟踪技术
    1. 反动态跟踪技术
        * 禁止跟踪中断。针对调试分析工具运行系统的单步中断与断点中断服务程序，恶意代码通过修改中断服务程序的入口地址来实现其反跟踪的目的。
        * 检测跟踪法。根据检测跟踪调试时和正常执行时的运行环境、中断入口和时间的不同， 采取相应的措施实现其反跟踪目的。
        * 其他反跟踪技术。如指令流队列法和逆指令流法等。
    2. 反静态跟踪技术
        * 对程序代码分块加密执行。
        * 伪指令法。伪指令法指将“废指令＂插入指令流中，让静态反汇编得不到全部正常的 指令，进而不能进行有效的静态分析。例如，Apparition病毒，每次新的病毒体可执行代码被编译器编译出来时都要被插入一定数量的伪指令，不仅使其变形，而且实现了反跟踪的目的。不仅如此，伪指令技术还广泛应用千宏病毒与脚本恶意代码之中。
2. 加密技术
    加密手段：信息加密、数据加密和程序代码加密
     Cascade 是第一例采用加密技术的DOS 环境下的恶意代码，其解密器稳定，能够解密内存中加密的程序体
    Mad 和 Zombie 是 Cascade 加密技术的延伸
3. 模糊变换技术



