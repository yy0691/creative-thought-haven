---
category: study-net
date: 2025-03-10
excerpt: "\u7F51\u7EDC\u547D\u4EE4"
tags:
- "\u7B14\u8BB0"
- "\u7F51\u7EDC\u5B89\u5168"
- "Web\u5B89\u5168"
title: "\u7F51\u7EDC\u547D\u4EE4"
---
# 网络命令

# 已开启端口查询


```Bash
netstat -anltup  //linux
netstat -ano     //windows
```

# Iproute2与net-tools

## 安装

iproute2工具地址：[www.linuxgrll.com](http://www.linuxgrll.com/anonymous/iproute2/NEW-OSDL/)

net-tools工具安装：`yum -y install net-tools`

## 介绍

|iproute2套装工具命令 |net-tools套装工具命令 |说明 |
|---|---|---|
|ip addr |ifconfig |查看网卡信息、ip、MAC等 |
|ip neigh |arp |查看arp缓存 |
|ip -s link |ifconfig -s |查看网卡收发数据包的大小RX:收、TX：发 |
|ip addr add 192.168.100.100/24 dev ens33 |ifconfig add ens33 192.168.100.100/24 |为ens33网卡添加一个临时IP地址 |
|ip addr del 192.168.100.100/24 dev ens33 |ifconfig del ens33 192.168.100.100./24 |为ens33网卡删除一个IP地址 |
|ip route |route -nnetstat -r |查看路由表 |
|ip route add 192.168.1.0/24 via 192.168.188.1 |route add -net 192.168.1.0/24 gw 192.168.188.1 |添加路由条目 |
|ip route del 192.168.1.0/24 via 192.168.188.1 |route del -net 192.168.1.0/24 gw 192.168.188.1 |添加路由条目 |
| |route add default gw 192.168.188.2 |添加默认路由 |
# 查看及测试网络


```Bash
<span style="color: #FBBFBC">ifconfig</span>命令：查看已启用的网络接口信息
#如果想要查看指定网卡信息，直接在后面跟上网卡名字
'ens33':第一块以太网卡的名称 'en'是'EtherNet','s' 表示热插拔设备'33'表示插槽编号
lo：”回环“网络接口，lo即loopback；不代表真正的网络接口，而是一个虚拟的网络接口，其IP默认是127.0.0.1，回环测试通常仅用于对本机的网络测试

<span style="color: #FBBFBC">hostname</span>：查看主机名称

<span style="color: #FBBFBC">netstat</span>：查看网络连接情况·
-a：显示当前主机中所有活动的网络连接信息（包括监听、非监听状态的服务端口）
-n: 以数字的形式显示相关的主机地址、端口等信息
-r: 显示路由表信息
-l: 显示处于监听（Listening）状态的网络连接及端口信息
-t: 查看TCP（Transmission Control Protocol 传输控制协议）相关信息
-u: 查看UDP（User Datagram Protocol 用户数据报协议）相关信息
-p: 显示与网络连接相关联的进程号、进程名称信息（该选项需要root权限）

<span style="color: #FBBFBC">ping</span>：测试网络连通性（默认会一直ping）
ping -c 3 www.baidu.com       #发送3个报文后停止
ping -l 6000 www.baidu.com                 #第一次直接发送6000个报文
ping -f www.baidu.com                                        #快速发送ICMP报文，进行压力测试
ping -s 6000 www.baidu.com                #每个报文携带6000个字节

<span style="color: #FBBFBC">traceroute</span>：跟踪数据包的路由途径
<span style="color: #FBBFBC">nslookup</span>：测试DNS域名解析，需要安装DNS客户端程序bind-utils
```

# 网络配置命令

## ifconfig

> 修改网卡的地址、状态


`ifconfig ens33 192.168.1.2/24`

## **修改主机名称（临时生效）**


```Bash
hostname woniuyang
bash      #启用新的Shell会话
```

## 设置永久主机名


```Bash
vi /etc/hosename
root
```

## IP地址修改

默认情况下，Linux的IP地址为DHCP动态分配，而面向服务器应用场景，通常建议设置为静态IP


```Bash
#1. 查看默认网关，运行route命令
ip route
#2. 确认动态IP地址及网段等信息
ip address
#3. 编辑 
/etc/sysconfig/network-scripts/ifcfg-ens33
```


```Bash
[root@yuyuan ~]# cat /etc/sysconfig/network-scripts/ifcfg-ens33 
TYPE=Ethernet
PROXY_METHOD=none
BROWSER_ONLY=no
#BOOTPROTO=dhcp          //隐藏
BOOTPROTO=static         //设置为静态IP
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=eui64
NAME=ens33
UUID=bdfddee2-4ebd-4d1e-8e83-350564b7db5d
DEVICE=ens33
ONBOOT=yes

#手工指定静态IP地
IPADDR=192.168.116.88
NETMASK=255.255.255.0
GATEWAY=192.168.116.2
DNS1=192.168.116.2
```

## 临时修改DNS服务器地址

需修改域名解析配置文件：`vi /etc/resolv.conf`


```Bash
[root@root~]# vi /etc/resolv.conf
# Generated by NetworkManager
search localdomain
nameserver 114.114.114.114
nameserver 8.8.8.8

[root@root~]# nslookup wwww.baidu.com
Server:    114.114.114.114
Address:   114.114.114.114#53

Non-authoritative answer:
Name: www.baidu.com
Address:IP
```

## 本地主机映射文件


```Bash
[root@root]vi /etc/hosts

ping www.root.com
```

# 请求网络中的内容

## Curl

> 利用URL规则在命令行下工作的文件传输工具



```Bash
#向服务器发起get请求
curl http://www.root.com
#将请求的内容保存到文件中
curl -o root.html http://www.root.com
#下载某个文件
curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo
```

## Wget

> 非交互式的网络文件下载工具



```Bash
#直接将文件下载到当前目录进行保存
wegt https://mirrors.aliyun.com/repo/Centos-7.repo
#将下载的内容指定文件名及存放位置
wget -O /Centos-7.repo https://mirrors.aliyun.com/repo/Centos-7.repo
#断点续传
wget -c https://mirrors.aliyun.com/repo/Centos-7.repo
#后台下载
wget -b https://mirrors.aliyun.com/repo/Centos-7.repo
```

# 流量监控工具 TCPDump

## 概述

> 网络数据采集分析工具；支持针对网络层、协议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句来帮助去掉无用的信息
> 基于数据包的五元组（源IP、目的IP、源端口、目的端口、协议）


## 安装并查看帮助信息

`yum -y install tcpnamp`

`tcpdump --help`

## 常用功能

### 抓取ARP协议

|选项 |功能 |备注 |
|---|---|---|
|`-i` |指定网络接口 | |
|`-b` |在网络层上选择协议 | |
示例代码：`tcpdump -b arp -i ens33`

### 指定网卡和主机抓包

示例：`tcpdump -i any host 10.10.254.12`

`#host` 后面加主机名

### 写入文件并查阅报文

`tcpdump -i any host 10.10.254.12 -nn -v -w client.pcap`

|选项 |功能 |备注 |
|---|---|---|
|`-nn` |禁止反向解析 | |
|`-v` |显示详细抓包信息 | |
|`-w` |写入到client.prep | |
|`-r` |查阅报文 | |
### 指定来源IP或目的IP 网段

`tcpdump -i any src host 192.168.1.1 -nn`

### 指定每个报文抓包字节数

`tcpdump -nn -i any -s 84 host 192.168.1.1`

<span style="color: #E0E1E4"><mark style="background-color: #F2F3F5">TIps：Icmp 协议默认为56字节数据+28字节ICMP头，一共84字节</mark></span>

### 抓传输层指定端口

<span style="color: #D4C1F3">端口：TCP、UDP</span>

`tcpdump -nn -i any tcp port 80`

### 使用逻辑表达式

<span style="color: #D4C1F3">逻辑表达式：or、and、not</span>

`tcpdump -nn -i any host 192.168.1.1 and icmp`

### 指定数据包大小过滤

<span style="color: #D4C1F3">选项：greater、less</span>

`tcpdump -nn -s 0 -i any host 192.168.1.1 and greater 1000 and icmp` 大于1000字节

### 抓取指定flag位的报文

`tcpdump -nn -i any -s 0 -c 1 'tcp[tcpflags]&tcp-syn !=0'`

