---
category: study-tech
title: HTTPS
date: 2023-05-01
excerpt: Web安全、网络安全、笔记
tags:
  - 笔记
  - 网络安全
  - Web安全
---

# HTTPS

Https=http+ssl/tls

1. **加密算法**
2. **PKI体系（公钥基础设施）**
3. 证书
4. **部署HTTPS服务器**
   
    部署CA证书服务器
    
5. **分析HTTPS流量**
   
    分析TLS
    

# 一、HTTPS协议

- 在Http的通道上增加了安全性，传输过程通过加密和身份认证来确保传输安全性

## 1. TLS

- 传输层安全协议，SSL和TLS其实是一个协议，SSL2.0版本，自SSL3.0版本后更名为TLS1.0，目前最高版本TLS1.3，使用最为广泛的是TLS1.2版本
- 设计目标
    - 保密性：所有的信息都加密传输
    - 完整性：校验机制
    - 认证：双方都配备证书，防止冒充
    - 互操作、通用性
    - 可扩展
    - 高效率
- 发展史

## 2. HTTP的缺陷

- 明文传输
- 只对传输数据的长度进行完整性校验，数据是否有被篡改是不做确认的

## 3. HTTPS好处

- 在传输数据之前，客户端会和服务器端去协商数据在传输过程中的加密算法，包含自己的非对称加密的密钥交换算法（RSA/DH），数据签名摘要算法（MD5/SHA），加密传输数据的对称加密算法（DES/3DES/AES）
- 客户端生成随机的字符串，通过协商好的非对称加密算法，使用服务端的公钥对该字符串进行加密，发送给服务端。服务端接收到之后，使用自己的私钥解密得到该字符串，在随后的数据传输中，使用这个字符串作为密钥进行对称加密。

![](https://cdn.jsdelivr.net/gh/yy0691/img-bed@main/Net_Safe_Notion/Untitled%2068.png)

# 三、PKI体系

## 1. 基本概念

- **公钥基础设施**
    - 通过使用公钥技术（非对称算法）和数字签名来确保信息安全
    - 公钥加密技术（非对称加密算法）、数字证书、CA（证书颁发机构）、 RA（证书注册机构）组成
- **实现的功能**
    - 身份验证
    - 数据完整性
    - 数据机密性
    - 操作不可否认性
- **身份认证及完整性验证**
    - 发送方ALice首先将原始数据通过摘要算法（SHA）算出信息摘要，并且用自己的私钥进行签名得到数字签名，将数字签名和原始数据发送给接收方bob
    - 接收方bob收到Alice发送来的原始数据和数字签名后，将原属数据通过相同的（SHA）得出信息摘要，再使用Alice的公钥，将数字签名解开得出Alice的信息摘要（完成ALice的身份认证），对比两个摘要是否一致，如果一致，说明数据在传输过程中没有被修改。

![](https://cdn.jsdelivr.net/gh/yy0691/img-bed@main/Net_Safe_Notion/Untitled%2069.png)

- 数字证书
    - 保证密钥的合法性
    - 证书的主体可以是用户、计算机、服务等
    - 证书包含的信息：
        - 使用者的公钥
        - 使用者的标识
        - 有效期
        - 颁发者的标识信息
        - 颁发者的数字签名

## 2. 数据安全传输案例

![](https://cdn.jsdelivr.net/gh/yy0691/img-bed@main/Net_Safe_Notion/Untitled%2070.png)

# 3. 数字证书颁发机构

- CA主要是进行颁发和管理数字证书
- CA是权威证书颁发机构，为了公正“公钥”的合法性
- 机密性：使用对方的公钥加密
- 身份验证/数字签名：使用自己的私钥

[http://10.1.1.2/certsrv/](http://10.1.1.2/certsrv/)

# 4. PKI实验

- 微软搭建的CA**：[http://10.1.1.2/certsrv/](http://10.1.1.2/certsrv/)**
1. 安装IIS、DNS服务器，CA组件
2. 在IIS上建立一个站点（必须使用域名访问），部署DNS服务器，用另一台虚拟机访问网站
3. 打开IIS，先创建证书申请文件
4. 向CA申请证书：打开网页[**http://10.1.1.2/certsrv/**](http://10.1.1.2/certsrv/)并向CA发送web服务器申请文件（高级证书申请）
5. CA颁发证书
6. 打开网页[**http://10.1.1.2/certsrv/](http://10.1.1.2/certsrv/)** —**查看挂起的证书申请状态**—下载证书——在web服务器上安装证书（完成证书申请）

**要求SSL通道：**

1. 网站右键网站绑定——添加网站绑定HTTPS
2. 在web服务器上启用SSL443
3. 要求用户必须使用443访问，不能使用80访问

**网站设置必须要求客户端证书：**

1. 申请一个web浏览器证书（XP用IE浏览器才可以申请，其他浏览器不行）
2. 下载web浏览器证书

---

- **关闭IE安全增强配置：服务器管理器**